{% load i18n %}

<!-- Preloader for load detail -->
<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 text-center" ng-if="!itemDetailLoad">
    <h2>{% trans "Loading detail..." %}</h2>
</div>
<!-- Error messages -->
<div class="item-in-cart-message row">
    <div class="col-lg-3 col-md-3 col-sm-3 col-xs-4 text-center">
        <span ng-if="itemDetailLoadError">[[ itemDetailLoadError ]]</span>
    </div>
</div>

<div class="wrapperOnList col-lg-12 col-md-12 col-sm-12 col-xs-12" ng-if="itemDetailLoad">
    <div class="row">

        <div class="col-lg-10 col-md-9 col-sm-9 col-xs-6">
            <h3 class="detail-item-attr">
                {% trans "ID:" %}[[ itemDetail.id ]]
            </h3>
        </div>

        <div class="col-lg-2 col-md-3 col-sm-3 col-xs-6 text-right" ng-if="isAuthUserIsOwner()">
            <div class="btn-group">
                <a class="btn btn-primary" ng-href="#/[[ itemDetail.id ]]/edit">
                    {% trans "Edit" %}
                </a>
                <a class="btn btn-primary dropdown-toggle" data-toggle="dropdown" href="javascript:void(0);">
                    <span class="fa fa-caret-down"></span></a>
                <ul class="dropdown-menu">
                    <li><a ng-href="#/[[ itemDetail.id ]]/edit"> {% trans "Edit" %}</a></li>
                    <li><a ng-href="#/[[ itemDetail.id ]]/action/add"> {% trans "Add action" %}</a></li>
                    <li class="divider"></li>
                    <li class="disabled"><a href="javascript:void(0);">
                        <i class="i"></i> {% trans "Add item" %}</a>
                    </li>
                </ul>
            </div>
        </div>

    </div>
    <h3>{% trans "Name:" %}[[ itemDetail.name ]]</h3>

    <h3>{% trans "Price:" %}
        <span ng-class="{'oldprice' : itemDetail.action_price}">
            [[ itemDetail.price | currency:"₴" ]]
        </span>
        <span class="newprice animated infinite pulse" ng-if="itemDetail.action_price">
            [[ itemDetail.action_price| currency:"₴"  ]]
        </span>
    </h3>
    <pre>[[ itemDetail.description ]]</pre>
    <h3 class="word-break" ng-show="itemDetail.image_url.length">{% trans "Image url:" %}
        <small>[[ itemDetail.image_url ]]</small>
    </h3>

    <h4 ng-show="itemDetail.rates">{% trans "Rating:" %}[[ itemDetail.rates | limitTo:3 ]]</h4>


    {% if user.is_authenticated %}
        <h4 ng-hide="greet">{% trans "Rate item:" %}
            <rating ng-model="rate" max="max" readonly="isReadonly" on-hover="hoveringOver(value)"
                    on-leave="overStar = null" titles="['one','two','three']" ng-click="isReadonly=true;addRate(rate);">

            </rating>
        </h4>
        <h4 class="rate-success-text" ng-show="greet">{% trans "Thanks for rate" %}</h4>
    {% endif %}


    <progressbar max="maxx" value="dynamic" class="col-lg-3 col-md-4 col-sm-5 col-xs-6"><span class="progressbar-text">[[dynamic]] / [[maxx]]</span>
    </progressbar>
    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
        <h3 ng-show="itemDetail.categories.length">{% trans "Categories:" %} </h3>
        <ul>
            <li ng-repeat="category in itemDetail.categories">
                [[ category ]]
            </li>
        </ul>
    </div>
    <hr>
    <h3 ng-show="itemDetail.comments.length">{% trans "Comments" %}</h3>

    <div class="comment-unit col-md-8 col-sm-10 animated slideInUp" ng-show="appendComment">
        <h3>
            <small>[[ appendComment.username ]]</small>
        </h3>
        <h4>[[ appendComment.message ]]</h4>
    </div>
    <div class="comment-unit col-md-8 col-sm-10"
         ng-repeat="comment in itemDetail.comments|startFrom:(currentPage - 1) * pageSize | limitTo:pageSize">
        <h3>
            <small>[[ comment.username ]]</small>
        </h3>
        <pre>[[ comment.message ]]</pre>
    </div>
    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 text-center"
         ng-show="isCommentsExistsAndCommentsLengthBiggerThenPagesize()">
        <pagination total-items="itemDetail.comments.length" ng-model="currentPage"
                    items-per-page="pageSize"></pagination>
    </div>


    <div class="comment-form col-md-8 col-sm-10">
        <h1 ng-hide="hideCommentForm">
            <small>{% trans "Add comment" %}</small>
        </h1>
        <h4 class="error-comment-message" ng-show="errorComment.data.username">
            {% trans "Username:" %}
            <ul>
                <li ng-repeat="error in errorComment.data.username">
                    [[ error ]]
                </li>
            </ul>
        </h4>
        <h4 class="error-comment-message" ng-show="errorComment.data.message">
            {% trans "Message:" %}
            <ul>
                <li ng-repeat="error in errorComment.data.message">
                    [[ error ]]</li>
            </ul>
        </h4>
        <form class="form-horizontal ng-pristine ng-valid" name="add_comment_form" role="form" method="POST"
              ng-submit="addComment()" ng-hide="hideCommentForm">

            <div class="form-group"><label class="col-md-2 control-label" for="id_username">{% trans "Username" %}</label>

                <div class="col-md-7"><input class="form-control" id="id_username" maxlength="50" name="username"
                                             placeholder="username" required="required" title=""
                                             type="text" ng-model="username"></div>
            </div>
            <div class="form-group"><label class="col-md-2 control-label" for="id_message">{% trans "Message" %}</label>

                <div class="col-md-7"><textarea class="form-control" cols="40" id="id_message" name="message"
                                                placeholder="message" required="required" rows="10"
                                                title="" ng-model="message"></textarea></div>
            </div>
            <div class="form-group">
                <div class="col-md-6 col-md-offset-2 text-center">
                    <button type="submit" class="btn btn-primary" name="submit">{% trans "Add comment" %}</button>
                </div>
            </div>
        </form>
        <div class="alert alert-success" ng-show="hideCommentForm">
            <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
            {% trans "Thanks for comment!" %}
        </div>
    </div>

</div>
