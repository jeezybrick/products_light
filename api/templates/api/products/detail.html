{% load i18n %}
{% load staticfiles %}

<!-- Preloader for load detail -->

<div layout="row" layout-sm="column" layout-align="space-around" ng-if="!itemDetailLoad">
    <md-progress-circular md-mode="indeterminate"></md-progress-circular>
</div>

<div class="wrapperOnList col-lg-12 col-md-12 col-sm-12 col-xs-12" ng-if="itemDetailLoad">
    <div class="row">

        <h1 class="item-detail-name">[[ itemDetail.name ]]</h1>

        <!-- breadcrumb -->
        <ol class="breadcrumb">
            <li><a href="{% url 'home' %}">{% trans "Home" %}</a></li>
            <li><a href="{% url 'products_index_ang' %}#/products"
                   ng-click="showDetailOfItem=false">{% trans "List of items" %}</a></li>
            <li ng-show="showDetailOfItem" class="active">{% trans "Detail of item" %}</li>
        </ol>
        <hr>

        <!-- Tabs -->
        <ul class="nav nav-tabs" role="tablist">
            <li role="presentation" class="active">
                <a ng-href="#/products/[[ itemDetail.id ]]" data-target="#/products/[[ itemDetail.id ]]">{% trans "About item" %}</a>
            </li>
            <li role="presentation">
                <a ng-href="#/products/[[ itemDetail.id ]]/comments" data-target="#/products/[[ itemDetail.id ]]/comments">
                    {% trans "Comments " %}<span class="badge"> [[ itemDetail.comments.length ]]</span>
                </a>
            </li>
        </ul>

        <!-- ID block -->
        <div class="col-lg-10 col-md-9 col-sm-9 col-xs-6">
            <h3 class="detail-item-attr">
               <small>
                   {% trans "ID:" %}[[ itemDetail.id ]]
               </small>
            </h3>
        </div>

        <!-- Button dropdown -->
        <div class="col-lg-2 col-md-3 col-sm-3 col-xs-6 text-right" ng-if="isAuthUserIsOwner()">
            <div class="btn-group">
                <a class="btn btn-primary" ng-href="#/products/[[ itemDetail.id ]]/edit">
                    {% trans "Edit" %}
                </a>
                <a class="btn btn-primary dropdown-toggle" data-toggle="dropdown" href="javascript:void(0);">
                    <span class="fa fa-caret-down"></span></a>
                <ul class="dropdown-menu">
                    <li><a ng-href="#/products/[[ itemDetail.id ]]/edit"> {% trans "Edit" %}</a></li>
                    <li><a ng-href="#/products/[[ itemDetail.id ]]/action/add"> {% trans "Add/edit action" %}</a></li>
                    <li><a href="javascript:;" class="alert-danger" ng-click="deleteItem()">{% trans "Delete" %}</a></li>
                    <li class="divider"></li>
                    <li><a href="{% url 'products_add' %}">
                        <i class="i"></i> {% trans "Add item" %}</a>
                    </li>
                </ul>
            </div>
        </div>

    </div>

    <!-- Image block -->
    <div class="col-lg-4 col-md-6 col-sm-4 col-xs-12 text-center animated fadeInLeft">
        <a ng-href="[[ itemDetail.image_url ]]" ng-if="itemDetail.image_url.length">
            <img ng-src="[[ itemDetail.image_url ]]"
             class="img-rounded img-responsive" alt="item-image">
        </a>
        <img src="{% static "products/images/no-image.png" %}"
             class="img-rounded img-responsive" alt="item-image" ng-if="!itemDetail.image_url.length">
    </div>

    <!-- Price and action price -->
    <div class="col-lg-8 col-md-6 col-sm-8 col-xs-12 animated fadeInRight">

        <div class="row" ng-if="itemDetail.action">
            <div class="action-block col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <h4>{% trans "Action ended at:" %}</h4>
                <div class="clock">[[ itemDetail.action.period_to | date:"medium"]]</div>

                <!-- Accordion for sort by category -->
                <div class="action-accordion col-lg-12 col-md-12 col-sm-12 col-xs-12 text-center">
                    <accordion close-others="oneAtATime">
                        <accordion-group heading="Read more" is-open="false"
                                         is-disabled="status.isFirstDisabled" popover="Click to read more about this action"
                                         popover-trigger="mouseenter">
                            <pre>[[ itemDetail.action.description ]]</pre>

                        </accordion-group>
                    </accordion>
                </div>

                <!-- Price with action -->
                <h3>{% trans "Price:" %}
                    <span ng-class="{'oldprice' : itemDetail.action.new_price}">
                        [[ itemDetail.price | currency:"₴" ]]
                    </span>

                            <!-- show new price if it defined in action -->
                    <span class="newprice animated infinite pulse" ng-if="itemDetail.action.new_price">
                        [[ itemDetail.action.new_price| currency:"₴"  ]]
                    </span>
                </h3>
            </div>
        </div>

        <!-- Categories -->
        <div class="item-detail-categories-list col-lg-12 col-md-12 col-sm-12 col-xs-12"
             ng-show="itemDetail.categories.length">
            <ul>
                <li ng-repeat="category in itemDetail.categories">
                    [[ category ]]
                </li>
            </ul>
        </div>

        <!-- Price without action -->
        <div ng-hide="itemDetail.action">
            <h3>{% trans "Price:" %}
                <span>[[ itemDetail.price | currency:"₴" ]]</span>
            </h3>
        </div>


        <!-- Rating block-->
            <h4 ng-hide="greet">{% trans "Average rating:" %}
                <rating ng-model="rate.value" max="max" readonly="isReadonly" on-hover="hoveringOver(value)"
                        on-leave="overStar = null" titles="['one','two','three']" ng-click="isReadonly=true;addRate();">

                </rating>
            </h4>
            <h4 class="rate-success-text" ng-if="greet">{% trans "Thanks for rate" %}</h4>

            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12" ng-if="isReadonly">
                <progressbar max="maxx" value="dynamic" class="col-lg-3 col-md-4 col-sm-5 col-xs-6">
                    <span class="progressbar-text">[[dynamic]] / [[maxx]]</span>
                </progressbar>
            </div>

        <!-- Description -->
        <div class="item-detail-description col-lg-12 col-md-12 col-sm-12 col-xs-12 hidden-sm">
            <pre>[[ itemDetail.description ]]</pre>
        </div>

    </div>

    <!-- Description for sm-display-->
    <div class="item-detail-description col-sm-12 hidden-lg hidden-md hidden-xs">
        <pre>[[ itemDetail.description ]]</pre>
    </div>

    <!-- Flash error messages -->
    <div class="col-lg-12">
        <div flash-message="4000"></div>
    </div>

</div>